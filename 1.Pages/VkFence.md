---
Type:
  - Page
aliases: 
Status:
tags: 
modifiedDate: 星期一, 五月 26日 2025, 8:58:15 晚上
---
[Vulkan的同步机制](Vulkan的同步机制.md)

## 定义

`VkFence` 主要用于 ***CPU 与 GPU 之间的同步***。它允许 CPU 阻塞（或轮询）以等待 GPU 上的某个或一组操作完成。相对于 `Semaphore` 来说，`Fence` 更“重”一些。

## 作用

- **提交时关联：** 当你向队列提交命令缓冲区时，可以同时提供一个 `Fence`。
- **CPU 等待：** CPU 可以调用 `vkWaitForFences` 函数来等待这个 `Fence` 被 GPU 信号化，表示所有在提交该 `Fence` 之前提交的命令都已完成。
- **重置：** `Fence` 在被信号化后不会自动重置，需要通过 `vkResetFences` 手动重置才能再次使用。

## 应用

- **帧同步：** 
	- 最典型的用法。CPU 通常会等待当前帧的渲染命令完成，以控渲染循环的节奏，避免 CPU 过早提交命令导致 GPU 队列溢出，同时也能管理资源的生命周期。
	- 等待 gpu 执行任务, 随后在 cpu 上计算相关信息
- **资源安全销毁：** 
	- 当你需要销毁一个 GPU 资源（如缓冲区、图像、描述符集）时，必须确保 GPU 已经完全停止使用它。通过等待一个 `Fence`，可以确认所有涉及该资源的 GPU 操作都已完成，从而安全地销毁资源。
- **从 GPU 读取数据：** 如果你需要将 GPU 生成的数据（例如，计算着色器的结果、帧缓冲区的像素数据）读取回 CPU 进行处理，必须使用 `Fence` 来确保 GPU 写操作已经完成。
