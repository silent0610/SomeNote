---
Type:
  - Page
aliases: 
tags: 
modifiedDate: 2025/06/19, 09:13:09
---

# C++内存区域

![[assets/20250619-1.png]]

## 堆

- 用于动态内存分配，即在程序运行时根据需要分配和释放的内存。
- 在 C++ 中，通常使用 `new` 来分配内存，`delete` 来释放内存。
- 程序员需要显式管理这部分内存（或者使用智能指针等机制来辅助管理），否则容易出现内存泄漏或悬挂指针。
- 空间相对较大，但分配和释放的开销也比栈大。
- 例如：`int* heapVar = new int(20); /* heapVar 指向堆上分配的内存 */ delete heapVar;`

## 栈

- 用于存储函数的**局部变量**、函数参数、函数调用的返回地址等。
- 内存由编译器自动分配和释放，遵循后进先出 (LIFO) 的原则。
- 空间有限，通常比堆小。
- 例如：`void func() { int localVar = 10; /* localVar 在栈上 */ }`
- 栈空间在进程生存周期一直都存在。当进程退出时，操作系统才会对栈空间进行回收。

## 静态数据区/全局数据区

- 这个区域用于存储：
    - **全局变量 (Global variables):** 在函数外部定义的变量。
    - **静态变量 (Static variables):** 包括在函数内部用 `static` 关键字声明的局部静态变量，以及在类中用 `static` 关键字声明的静态成员变量。
    - **常量数据 (Constant data):** 例如字符串字面量 (`"hello"`) 通常也存储在这里，并且常常是只读的。
- 这部分内存在**程序启动时分配，在程序结束时释放**。变量的生命周期贯穿整个程序的执行过程。

### 细分

- 静态数据区内部有时还会进一步细分为：
    - `.data` 段：存储已初始化的全局变量和静态变量。
        - 常量数据区 (`.rodata`): 存储常量数据,静态常量，如字符串字面量、**以及[[C++虚表|虚函数表 (vtbl)]]**。
        - 变量区: 已初始化的
    - `.bss` 段 (Block Started by Symbol)：存储未初始化或初始化为零的全局变量和静态变量。编译器通常会把这部分数据在程序加载时清零。

## 代码区

存放程序的二进制代码，不允许修改。
