---
Type: 
aliases:
  - Rejection Sampling
tags: 
modifiedDate: 2025/06/30, 13:51:13
---

# 拒绝采样

## 定义

一种优化[[重要性采样]]的算法

### 前提

- 目标PDF: `p(x)`
- 提议PDF: `q(x)` (我们知道如何从中采样)
- 常数 `M`，使得 `p(x) ≤ M * q(x)`

### 循环执行以下步骤，直到获得足够数量的样本

- **提议**: 从 `q(x)` 中生成一个样本，记为 `x_candidate`。
- **生成随机阈值**: 从均匀分布 `U[0, 1]` 中生成一个随机数，记为 `u`。
- **计算接受概率**: 计算 `α = p(x_candidate) / (M * q(x_candidate))`。这个值在 `[0, 1]` 之间，代表了在 `x_candidate` 位置，“地面”相对于“天花板”的高度比例。
- **判断**:
    - 如果 `u ≤ α`，则 `x_candidate` 是一个好样本，**接受**它，将其加入我们的样本列表中。
    - 否则，**拒绝**它，并**循环回到第1步**。

## 得失

**优点**: 非常通用。只要您能评估 `p(x)`，并且能找到一个简单的“罩子” `q(x)`，就能用。

**缺点**: 效率。如果 `q(x)` 的形状和 `p(x)` 差别很大，这个空隙就会很大，导致绝大多数采样都被拒绝，效率极低。
