---
Type:
aliases: 
tags: 
modifiedDate: 2025/06/17, 18:13:46
---

# C++程序编译流程

## **版本1：**

高级语言代码会经过四个阶段，从而形成可执行的目标二进制代码，分别是：预处理器，编译器，汇编器，链接器。

## **版本2：**

1. 预处理阶段：根据预处理指令，对原始代码进行修改，由.cpp文件得到.i文件；
2. 编译阶段：把 `.i` 文件**编译成汇编代码**`.s` 文件；
3. 汇编阶段：把汇编代码进一步**翻译成机器代码**，得到二进制的目标文件 `.obj`；
4. 链接阶段：将目标文件和其他目标文件、库文件**链接起来**形成可执行文件.exe。

## **版本3：**

1. 预处理阶段：
    1. 移除所有的#define，进行宏定义的展开替换。
    2. 处理条件预编译指令（#if，#ifdef，#endif，#elif，#else）等。
    3. 处理#include预编译指令，将文本内容替换到对应位置。
    4. 删除所有的注释内容。
    5. 保留所有的#pragma编译器指令。
    6. 添加行号和文件标识，以便在编译过程中，编译器能够产生调试使用的行号信息。
    7. 最终由.cpp文件生成.i文件。
2. 编译阶段：
    1. 将预处理之后的.i文件，进行一系列的词法分析、语法分析、语义分析和优化之后，生成相应的汇编代码[^1]，即.s文件
3. 汇编阶段：
    1. 将汇编代码转变成机器可以执行的指令（机器码[^2]文件）。
    2. 汇编器的汇编过程相对于编译器来说更简单，没有复杂的语法、语义，更不需要做指令优化，只是根据汇编指令和机器指令的对照表一一翻译过来，汇编过程有汇编器as完成。
    3. 经汇编之后，产生目标文件xxx.o（Linux ）、xxx.obj（Window）。
4. 链接阶段：
    1. 将不同的源文件产生的目标文件进行链接，从而形成一个可以执行的程序（xxx.exe）。
    2. 链接分为静态链接和动态链接。

[^1]: mov, lea
[^2]: 01
