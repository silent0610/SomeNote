---
Type:
aliases: 
tags: 
modifiedDate: 2025/07/09, 17:02:11
---

# 遮挡剔除面经

## CPU端有什么遮挡剔除的方法？

剔除方法有: 视锥体剔除, 小三角剔除, 细节剔除, 背面剔除, 入口剔除, 遮挡剔除
其中能发生在 CPU 端的可能有: 
- 视锥体剔除
- [[入口剔除]]
- 以及遮挡剔除中的软件三角形光栅化方法。

## 几何处理的剔除是在什么层级上的

- 剔除 culling 是指找到某些处于范围之外的物体, 并让这些物体不被渲染的过程
- 裁剪 clipping 是指默写物体于范围边界相交. 需要移除范围外的部分, 保留范围内的部分.

在几何处理阶段中的是裁剪, 对于那些与立方体相交的三角形, 在边界处生成新的顶点, 从而移除位于立方体之外的图元, 是在三角形级别上进行的裁剪.

## 在整个渲染管线当中一共进行过几次裁剪（剔除）？

剔除和裁剪可以分为如下四个粒度

### 1.物体级别

- CPU 视锥剔除
- CPU 遮挡剔除
    - 判断那些**位于视锥体内**的物体，是否被其他更近的、不透明的物体（遮挡物，Occluder）**完全遮挡**。
- CPU LoD

## 2.cluster 级别 (可选)

- [[nanite]] 中按 cluster 级别剔除

## 3.三角形级别

- GPU 背面剔除 处于几何处理和光栅化之间的过渡阶段
- 几何处理阶段 裁剪
- 细节剔除和小三角形剔除
    - mesh shader? 和传统管线差距较大

## 4.像素级别

- 深度测试

## 背面剔除有哪些实现方法？

在三角形级别上，有以下方法来判断单个三角形是否背对相机：
1. 利用三角形正面顺序, 如逆时针, 在二维平面空间中计算三角形的带符号面积, 如果为负, 则背对相机 **是最常用、最高效的方法，因为它被固化在了GPU硬件里，几乎没有性能开销**
2. 使用负观察向量 (三角形上任意一点, 如顶点)和三角形法线（在世界空间或视图空间）进行点乘, 若为负, 则不是面向观察者的.  [[我的软渲染器]]
3. 在应用投影矩阵之后，在裁剪空间中构建向量 $\overline{\mathbf{v}}=\left(v_{x}, v_{y}, v_{w}\right)$[^1]，并计算行列式 $d=\left|\overline{\mathbf{v}}_{0}, \overline{\mathbf{v}}_{1}, \overline{\mathbf{v}}_{2}\right|$ 的值。当d≤0时，可以对这个三角形进行裁剪。

[^1]: 三个顶点
