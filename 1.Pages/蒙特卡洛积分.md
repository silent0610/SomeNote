---
Type:
  - Page
aliases: 
tags: 
Status: 
modifiedDate: 星期四, 五月 29日 2025, 9:18:10 晚上
---

> [图形学](图形学.md)

---

## 定义

使用**随机抽样**来**近似计算定积分**

这是待求积分, 

$$
\mathrm{I=\int_a^b f(x)dx}
$$

根据大数定律推导出的蒙特卡洛积分, 可以用如下的形式**近似无偏**计算, 

$$
I \approx\frac{1} {N} \sum_{i=1}^{N} f ( x_{i} ) \cdot( b-a )
$$

==这是怎么得到的?==
蒙特卡洛积分的**核心机制**是**利用随机抽样**，而这些随机样本**是来自某个概率分布的**, 上面的例子是随机均匀采样, 下面的是按 px 分布

### 公式推导

我们要计算的是什么? 是半球的光照积分
例如，我们知道 $E[X]=∫x⋅p(x)dx$。如果我们想求 $∫f(x)dx$，我们可以把 $f(x)$ 拆分成 $\frac{f(x)}{p(x)}​⋅p(x)$，那么 $∫f(x)dx=E[\frac{f(x)}{p(x)}​]$ (见期望定义), 而 $E[\frac{f(x)}{p(x)}​]=\frac{1} {N} \sum_{i=1}^{N} \frac{f ( x_{i} )} {p ( x_{i} )}$
也就是有 (当 $p (x)=\frac{1}{(b-a)}$ 时, 即均匀采样, 就有上面的形式 $I \approx\frac{1} {N} \sum_{i=1}^{N} f ( x_{i} ) \cdot( b-a )$)  
==这里 f (x) 可能也有自己的分布, 但是渲染中认为其是均匀的, 不做考虑==

$$
\int f ( x ) \, d x \approx\frac{1} {N} \sum_{i=1}^{N} \frac{f ( x_{i} )} {p ( x_{i} )}
$$

> 类似的还有 **深度学习的方法** 辛普森法, 龙贝格积分法等等,马尔科夫链等等, **深度学习值得注意**, 其它不重要

**渲染方程 (Rendering Equation)** 图形学中的光照计算本质上是一个复杂的积分问题，它需要对半球上的所有入射光进行积分。

$$
L_{o} ( \omega_{o} )=\int_{\Omega} f_{r} ( \omega_{i}, \omega_{o} ) L_{i} ( \omega_{i} ) ( n \cdot\omega_{i} ) d \omega_{i}
$$

这个积分通常没有解析解，并且积分域（半球 Ω）是连续的。
所以需要用蒙特卡洛积分来近似计算

## 相关优化技术

[【光线追踪系列十四】蒙特卡洛积分与重要性采样_积分近似重要性抽样-CSDN博客](https://blog.csdn.net/qq_35312463/article/details/116754314)  

[重要性采样](重要性采样.md)
[重要性重采样](重要性重采样.md)
[[加权蓄水池采样]]
[[多重重要性采样]]
[[蓄水池时空重要性采样]]

### 目标

- 样本数量严格固定, 可以少, 但不能多
1. 减小方差, 提高有效性
2. 无偏均值, 无偏性, 尽可能无偏, 但绝大部分方法都是有偏的
