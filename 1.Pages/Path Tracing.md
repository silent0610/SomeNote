---
Type:
  - Page
aliases:
  - 路径追踪
tags: 
modifiedDate: 2025/06/30, 17:38:41
---

# Path Tracing

## 定义

- 一种光追的实现方式
- 目前主流
- 模拟光线在场景中所有可能的传播路径​, 即按分布投射光线

## 一些细节

- 光线在任意表面（包括漫反射表面）都可能随机弹射，模拟光线在场景中的多次弹射。
- 通过蒙特卡洛积分计算像素的光照贡献，最终收敛到物理准确的渲染结果（如真实感极强的电影级画面）。

### 流程

1. ​**​主光线发射​**​
    - 从摄像机出发，为每个像素发射 n 条初始光线。
2. ​**​路径构建（Path Construction）​**​
    - 光线与场景求交，找到最近的交点。
    - **根据表面材质（如粗糙度, 金属度等）参数**, 按照一定分布生成新的光线
        - 一根
        - 若 k 根, 计算量爆炸
3. ​**​光照计算​**​
    - ​**​直接光照​**​：从交点向光源发射阴影光线（Shadow Ray），检测遮挡并计算直接光照贡献。
    - ​**​间接光照​**​：通过随机弹射的光线路径间接收集周围环境的光照（如墙面反射的柔光）。
4. ​**​路径终止​**​
    - 光线命中光源时累积光源颜色，或通过俄罗斯轮盘赌终止路径。
5. ​**​累积结果​**​
    - 通过[蒙特卡洛积分](蒙特卡洛积分.md)计算
    - [为什么使用蒙特卡洛积分](为什么使用蒙特卡洛积分.md)

### 另一种表述

- 从摄像机为某个像素发射一条光线。
- 当光线击中表面时，**不再做决策**，而是根据材质的BRDF进行**重要性采样**，**随机选择一个方向**继续弹射。
    - 通常情况下会直接发射一条指向光源的光线, 加速拟合
- 光线不断弹射，直到达到最大深度或飞出场景，形成一条**随机的光路 (Path)**。
- 计算这条单一路径对像素的贡献。
- 对同一个像素，**重复上述过程成百上千次**，追踪大量不同的随机路径。
- 将所有路径的贡献**平均**起来，就得到了该像素颜色的一个越来越精确的近似值。
