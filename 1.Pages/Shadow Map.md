---
Type:
  - Page
aliases:
  - 阴影贴图
  - 阴影映射
tags: 
Status:
modifiedDate: 2025/06/25, 10:51:34
---

# Shadow Map

一种最常见、最广泛使用的**实时阴影渲染技术**。
- **从光源视角“看”场景，把深度信息存在 Z-buffer 中，然后在主视角下判断像素是否被遮挡**。
- 能够被光源“看见”的任何物体都会被照亮，光源“看不见”的物体则都处于阴影中。

用于方向光
两 Pass 算法

## 实现

### Pass1

1. 将光源视为相机, 搭建光源的 Proj 和 view 矩阵
2. 渲染场景, 保存深度到 RT 中
3. 每个像素记录的是从光源出发到该物体表面的距离（depth）。

### Pass2

- 对于每个片元, 利用光源的 proj 和 view 计算该片元在光源空间的坐标, 以及对应的 uv
    - 可优化计算
- 根据 uv 采样深度贴图, 与光源空间的深度做对比
- 如果当前像素比 shadow map 中记录的值“更远”，说明被挡住了，是阴影；

## 一些细节

对于方向光, 使用正交投影

## 常见问题

- **阴影痤疮 (Shadow Acne) / 自相交问题**：[自阴影和阴影偏移](自阴影和阴影偏移.md)
- 只能生成硬阴影，无法生成软阴影. 
    - [软阴影](软阴影.md)
- 走样 [级联阴影贴图](级联阴影贴图.md)
